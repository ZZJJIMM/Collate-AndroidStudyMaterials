## Android事件分发机制-初探

@[TOC](Android 事件分发机制)
## 一、序言
事件分发机制——Android的一个重要知识点，它包含了点击事件、滑动事件、双击事件等一系列事件；它是人机交互的第一线，通过监控用户手指的不同操作，反馈不同的信息，并将这些事件分发给指定的View，完成用户手指操作的事件分发。
[事件分发](https://www.jianshu.com/p/38015afcdb58/)
## 二、文章中心（通过以下问题去了解这篇文章）
1. Android事件分发中，事件指的是什么？
2. Android事件是怎样分发的？	
3. Android事件分发顺序是怎样的？

## 三、Android事件分发机制概念分析
- Android事件分发机制中，事件是什么？
	[事件的基本概念](https://www.jianshu.com/p/ec501ff83931)
	是用户触摸屏幕产生的事件，包含了点击（Down）、滑动（Move）、抬起（Up）、取消（Cancel）
	将用户操作的对象Down、Up、Move、Cancel对象封装为MotionEvent事件
- 什么是事件分发

		MotionEvent事件产生后，系统需要将这个在dispatchTouchEvent()进行分发
## 四、Android事件分发顺序
事件分发顺序：Activity->ViewGroup->View 
Activity（dispatchTouchEvent、onTouchEvent）
ViewGroup（dispatchTouchEvent、onInterceptTouchEvent、onTouchEvent）
View（dispatchTouchEvent、onTouchEvent）
![在这里插入图片描述](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy85NDQzNjUtZWVlYmVkZTU1ZjU1YjA0MC5wbmc?x-oss-process=image/format,png#pic_center)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200603104947854.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3h5emFoYWhh,size_16,color_FFFFFF,t_70#pic_center)
[事件分发实战模拟](https://www.cnblogs.com/liqw/p/11490088.html)
## 五、事件分发源码分析
用户触摸屏幕，生成触摸事件
![在这里插入图片描述](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMDUyMTU4OS1mNGFmYmU5NGI3NjU3YWYzLnBuZw?x-oss-process=image/format,png)
Activity 的事件分发，源码调用顺序

MainActivity.dispatchTouchEvent() -> Activity.dispatchTouchEvent (getWindow.superDispatchTouchEvent) ->PhoneWindow.superDispatchTouchEvent -> DecorView.superDispatchTouchEvent ->ViewGroup.dispatchTouchEvent（进行事件分发）->ViewGroup.onInterceptTouchEvent(是否拦截事件) ->  View.dispatchTouchEvent->View.onTouchEvent ->ViewGroup.onTouchEvent  ->MainActivity.onTouchEvent

ViewGroupLayout源码调用顺序：
ViewGroupLayout.dispatchTouchEvent ->ViewGroup.dispatchTouchEvent ->ViewGroupLayout.onInterceptTouchEvent->ViewGroup.onInterceptTouchEvent -> View.dispatchTouchEvent->View.onTouchEvent->ViewGroup.onTouchEvent -> ViewGroupLayout.onTouchEvent

MyView事件分发源码调用顺序：
MyView.dispatchTouchEvent ->View.dispatchTouchEvent ->myView .onTouchEvent ->View.onTouchEvent

## 六、总结